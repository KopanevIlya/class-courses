import{m as d,p as b,q as w,c as k,w as g,d as e,o as n,g as o,F as v,s as _,t as r,f as M,i as D,e as F,j as B,x as C,y as S}from"./app-DWZc5-h_.js";import{_ as V}from"./AuthenticatedLayout-Cx9opBqk.js";import"./ApplicationLogo--jkLOQ1e.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"font-semibold text-xl text-gray-800 leading-tight"},j={class:"py-12"},I={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},N={class:"bg-white p-4 rounded shadow"},A={key:0},E=["href"],O={__name:"Chat",props:{chat:Object,messages:Array},setup(p){const i=p,m=d(i.messages),l=d(""),u=d([]);let h=null;function x(t){u.value=Array.from(t.target.files)}function f(){fetch(`/chats/${i.chat.id}/messages`).then(t=>t.json()).then(t=>{m.value=t})}function y(){const t=new FormData;t.append("body",l.value),u.value.forEach(a=>t.append("files[]",a)),S.post(`/chats/${i.chat.id}/messages`,t,{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{l.value="",u.value=[],f()}})}return b(()=>{h=setInterval(f,3e3)}),w(()=>{clearInterval(h)}),(t,a)=>(n(),k(V,null,{header:g(()=>[e("h2",$," Чат: "+r(p.chat.name),1)]),default:g(()=>[e("div",j,[e("div",I,[e("div",N,[e("ul",null,[(n(!0),o(v,null,_(m.value,s=>(n(),o("li",{key:s.id},[e("strong",null,r(s.user.name)+":",1),M(" "+r(s.body)+" ",1),s.files&&s.files.length?(n(),o("ul",A,[(n(!0),o(v,null,_(s.files,c=>(n(),o("li",{key:c.id},[e("a",{href:`/storage/${c.path}`,target:"_blank"},r(c.original_name),9,E)]))),128))])):D("",!0)]))),128))]),e("form",{onSubmit:F(y,["prevent"]),enctype:"multipart/form-data"},[B(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>l.value=s),class:"border rounded px-2 py-1 mr-2",placeholder:"Введите сообщение"},null,512),[[C,l.value]]),e("input",{type:"file",multiple:"",onChange:x},null,32),a[1]||(a[1]=e("button",{class:"bg-blue-500 text-white px-3 py-1 rounded",type:"submit"},"Отправить",-1))],32)])])])]),_:1}))}};export{O as default};
